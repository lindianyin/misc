<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>LibU: Flow Control</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Intro</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Flow Control</h1><hr/><a name="_details"></a><h2>Overview</h2>
<p>The <a class="el" href="group__carpal.html">Flow Control</a> module is at the very core of LibU. It defines a number of macros that are used throughout the library code to guide the execution flow. They enforce an assertive programming style in which the code in the function body flows straight to the expected result and all the anomalies catched in the trunk are handled in a a special <code>err:</code> labelled branch. Each function body can be split into the following three blocks. </p>
<p>A declaration block: </p>
<div class="fragment"><pre class="fragment">    <span class="keywordtype">int</span> f (<span class="keywordtype">void</span>)
    {
        <span class="comment">// local variables initialization</span>
        <span class="keywordtype">char</span> *d = NULL;
        FILE *fp = NULL;
</pre></div><p> The trunk: </p>
<div class="fragment"><pre class="fragment">        <span class="comment">// malloc a 1024 bytes 0-filled chunk</span>
        dbg_err_sif ((d = <a class="code" href="group__alloc.html#gad508e24d765a79bd7e15feade062407c" title="Alloc a contiguous region of sz bytes and zero-fill it.">u_zalloc</a>(1024)) == NULL);

        <span class="comment">// open &quot;my.txt&quot; for writing</span>
        dbg_err_sif ((fp = fopen(<span class="stringliteral">&quot;my.txt&quot;</span>, <span class="stringliteral">&quot;w&quot;</span>)) == NULL);

        <span class="comment">// write to file</span>
        dbg_err_sif (fwrite(d, 1024, 1, fp) &lt; 1);

        <span class="comment">// free memory and close the file stream </span>
        <a class="code" href="group__alloc.html#ga8a480341289bf5fc1a72e7974c4a739d" title="Wrapper for free-like function, sanity checks the supplied pointer.">u_free</a>(d);
        (void) fclose(fp);

        <span class="keywordflow">return</span> 0;
</pre></div><p> The exception handling branch: </p>
<div class="fragment"><pre class="fragment">    err:
        <span class="comment">// invoke local resource dtors only in case they have been</span>
        <span class="comment">// allocated in the trunk and tell the caller that we have failed</span>
        <span class="keywordflow">if</span> (fp != NULL)
            fclose(fp);
        <span class="keywordflow">if</span> (d != NULL)
            <a class="code" href="group__alloc.html#ga8a480341289bf5fc1a72e7974c4a739d" title="Wrapper for free-like function, sanity checks the supplied pointer.">u_free</a>(d);

        <span class="keywordflow">return</span> ~0;
    }
</pre></div><p>Should the execution fail in the function trunk, a number of interesting info about the failed instruction and context are automatically supplied to the syslog machinery and redirected to the appropriate sink: </p>
<div class="fragment"><pre class="fragment">    Jan 15 12:27:27 tho-2 ./carp[14425]: [dbg][14425:main.c:20:f] (fp = fopen(<span class="stringliteral">&quot;my.txt&quot;</span>, <span class="stringliteral">&quot;w&quot;</span>)) == ((<span class="keywordtype">void</span> *)0) [errno: 13, Permission denied]
</pre></div><p>As you can see, these macros also show the nice side effect of neatly packing your code -- the LOC compression factor being nearly 1:3 compared to a properly formatted C program -- which of course increases readability and maintainability of the software, but, most of all, tries to protect the professional programmer from the nasty carpal tunnel syndrome (hence the header name <a class="el" href="carpal_8h_source.html">carpal.h</a>). This is no doubt a clear case in which "Go To Statement can be 
        Considered Benefical" -- if Dijkstra allows.</p>
<p>In all the macros that follow, the <code>msg_</code> prefix can be substituted by any of <code>dbg_</code>, <code>info_</code>, <code>notice_</code>, <code>warn_</code>, <code>err_</code>, <code>crit_</code>, <code>alert_</code>, <code>emerg_</code> strings, and the <code>label</code> argument deleted, since it is absorbed into the explicit prefix. As you may easily spot, each of these variant is in 1:1 correspondence with <code>syslog(1)</code> error levels. Also, the special <code>con_</code> prefix can be used to redirect the message to <code>stderr</code> and <code>nop_</code> to just don't log. </p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__carpal.html#ga8ef9cce7518dddade703d31c6637bbe7">msg_err</a>(label,...)&nbsp;&nbsp;&nbsp;do { msg(label, 0, __VA_ARGS__); goto err; } while(0)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Log a message and jump to the <code>err:</code> label.  <a href="#ga8ef9cce7518dddade703d31c6637bbe7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__carpal.html#gab805a13efce03fef1b7cbdd525bc7216">msg_if</a>(label, expr)&nbsp;&nbsp;&nbsp;do { if( expr ) msg_noargs(label, 0, #expr); } while(0)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Log a message if <code>expr</code> is true.  <a href="#gab805a13efce03fef1b7cbdd525bc7216"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__carpal.html#ga62bfdd64e0a9d27b1d993ec575b7cc44">msg_ifm</a>(label, expr,...)&nbsp;&nbsp;&nbsp;do { if(expr) { msg(label, 0, __VA_ARGS__); } } while(0);</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Log the given message if <code>expr</code> is true.  <a href="#ga62bfdd64e0a9d27b1d993ec575b7cc44"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__carpal.html#ga2757d0c14bd2caa556c52e054fcd2afd">msg_ifb</a>(label, expr)&nbsp;&nbsp;&nbsp;if( (expr) &amp;&amp; (msg_noargs(label, 0, #expr) ? 1 : 1) )</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Log a message if <code>expr</code> is true and enter the if-block.  <a href="#ga2757d0c14bd2caa556c52e054fcd2afd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__carpal.html#ga5bfb7bc6efa849511df25ddc306852f9">msg_return_if</a>(label, expr, err)&nbsp;&nbsp;&nbsp;msg_ifb(label, expr) { return err; }</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Log a message if <code>expr</code> is true and <code>return</code> with <em>err</em>.  <a href="#ga5bfb7bc6efa849511df25ddc306852f9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__carpal.html#ga4f38f94bff9d88bdc55d8a14e2cda238">msg_return_ifm</a>(label, expr, err,...)&nbsp;&nbsp;&nbsp;if(expr) { msg(label, 0, __VA_ARGS__); return err; }</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Log the given message if <code>expr</code> is true and return <code>err</code>.  <a href="#ga4f38f94bff9d88bdc55d8a14e2cda238"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__carpal.html#ga833c0608c6146af8e6a74926c66868b0">msg_return_sifm</a>(label, expr, err,...)&nbsp;&nbsp;&nbsp;if(expr) { msg(label, errno, __VA_ARGS__); return err; }</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Log the given message plus <code>strerror(errno)</code> if <code>expr</code> is true, and return <code>err</code>.  <a href="#ga833c0608c6146af8e6a74926c66868b0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__carpal.html#gad3d59576732645bbbaf993bc514946d1">msg_return_sif</a>(label, expr, err)&nbsp;&nbsp;&nbsp;do { if(expr) { msg_noargs(label, errno, #expr); return err; } } while(0)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Log a message plus <code>strerror(errno)</code> if <code>expr</code> is true, and return <code>err</code>.  <a href="#gad3d59576732645bbbaf993bc514946d1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__carpal.html#ga082a1ce6f49d9aec3b205c4db01520c4">msg_goto_if</a>(label, expr, gt)&nbsp;&nbsp;&nbsp;msg_ifb(label, expr) goto gt</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Log a message if <code>expr</code> is true and <code>goto</code> <code>gt</code>.  <a href="#ga082a1ce6f49d9aec3b205c4db01520c4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__carpal.html#ga6f584e72811229c5a34f24cef16c91be">msg_err_if</a>(label, expr)&nbsp;&nbsp;&nbsp;do { msg_ifb(label, expr) { goto err;} } while(0)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Log a message if <code>expr</code> is true and <code>goto</code> to the label <code>err</code>.  <a href="#ga6f584e72811229c5a34f24cef16c91be"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__carpal.html#gac0df443b0046c634bfda75cca75fe0e6">msg_err_rcif</a>(label, expr, errcode)&nbsp;&nbsp;&nbsp;do { msg_ifb(label, expr) { rc = errcode; goto err;} } while(0)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Log a message if <code>expr</code> is true, set <code>errcode</code> and <code>goto</code> to the label <code>err</code>.  <a href="#gac0df443b0046c634bfda75cca75fe0e6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__carpal.html#ga4f97457dfef06285886b8e4a496165c8">msg_err_ifm</a>(label, expr,...)&nbsp;&nbsp;&nbsp;do { if( (expr) ) { msg(label, 0, __VA_ARGS__); goto err; } } while(0)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Log the given message if <code>expr</code> is true and <code>goto</code> to the label <code>err</code>.  <a href="#ga4f97457dfef06285886b8e4a496165c8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__carpal.html#ga544a28cd51a330c6ad634f38ee313801">msg_err_sif</a>(label, expr)&nbsp;&nbsp;&nbsp;do { if(expr) { msg_noargs(label, errno, #expr); goto err; } } while(0)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Log a message and <code>strerror(errno)</code> if <code>expr</code> is true, then <code>goto</code> to the label <code>err</code>.  <a href="#ga544a28cd51a330c6ad634f38ee313801"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__carpal.html#gad2505c49f0a40f08bdb8ceb6dd2854f7">msg_err_sifm</a>(label, expr,...)&nbsp;&nbsp;&nbsp;do { if((expr)) { msg(label, errno, __VA_ARGS__);  goto err; } } while(0)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Log the user provided message and <code>strerror(errno)</code> if <code>expr</code> is true, then <code>goto</code> to the label <code>err</code>.  <a href="#gad2505c49f0a40f08bdb8ceb6dd2854f7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__carpal.html#gadced23755fa8b6d7423e8499318a1801">msg_strerror</a>(label, en)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Write a debug message containing the message returned by <code>strerror(errno)</code>.  <a href="#gadced23755fa8b6d7423e8499318a1801"></a><br/></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="ga8ef9cce7518dddade703d31c6637bbe7"></a><!-- doxytag: member="carpal.h::msg_err" ref="ga8ef9cce7518dddade703d31c6637bbe7" args="(label,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define msg_err</td>
          <td>(</td>
          <td class="paramtype">label, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"> <em>...</em>&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;do { msg(label, 0, __VA_ARGS__); goto err; } while(0)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Log a message of type <code>label</code> and jump to <code>err</code> label</p>
<p>For example: </p>
<div class="fragment"><pre class="fragment">      <span class="keywordflow">if</span> (stat(filename, &amp;sb) == -1)
          dbg_err(<span class="stringliteral">&quot;stat failed on file %s&quot;</span>, filename);
</pre></div> 
<p>Definition at line <a class="el" href="carpal_8h_source.html#l00114">114</a> of file <a class="el" href="carpal_8h_source.html">carpal.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga6f584e72811229c5a34f24cef16c91be"></a><!-- doxytag: member="carpal.h::msg_err_if" ref="ga6f584e72811229c5a34f24cef16c91be" args="(label, expr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define msg_err_if</td>
          <td>(</td>
          <td class="paramtype">label, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">expr&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;do { msg_ifb(label, expr) { goto err;} } while(0)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Log a message of type <code>label</code> if <code>expr</code> is true and <code>goto</code> to the label <code>err</code> (that must be in-scope). The <code>expr</code> text statement will be written to the log file.</p>
<p>For example: </p>
<div class="fragment"><pre class="fragment">      dbg_err_if ((rc = regexec(&amp;re, uri, 10, pmatch, 0)) != 0);
      ...
  err:
      u_dbg(<span class="stringliteral">&quot;no match found !&quot;</span>);
      <span class="keywordflow">return</span> ~0;
</pre></div> 
<p>Definition at line <a class="el" href="carpal_8h_source.html#l00256">256</a> of file <a class="el" href="carpal_8h_source.html">carpal.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga4f97457dfef06285886b8e4a496165c8"></a><!-- doxytag: member="carpal.h::msg_err_ifm" ref="ga4f97457dfef06285886b8e4a496165c8" args="(label, expr,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define msg_err_ifm</td>
          <td>(</td>
          <td class="paramtype">label, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">expr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"> <em>...</em>&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;do { if( (expr) ) { msg(label, 0, __VA_ARGS__); goto err; } } while(0)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Log a message of type <code>label</code> if <code>expr</code> is true and <code>goto</code> to the label <code>err</code> (that must be in-scope). The user-provided message is used instead of the <code>expr</code> text statement.</p>
<p>For example: </p>
<div class="fragment"><pre class="fragment">      dbg_err_ifm (cur == s, <span class="stringliteral">&quot;empty IPv4address / reg-name&quot;</span>);
      ...
  err:
      <span class="keywordflow">return</span> ~0;
</pre></div> 
<p>Definition at line <a class="el" href="carpal_8h_source.html#l00296">296</a> of file <a class="el" href="carpal_8h_source.html">carpal.h</a>.</p>

</div>
</div>
<a class="anchor" id="gac0df443b0046c634bfda75cca75fe0e6"></a><!-- doxytag: member="carpal.h::msg_err_rcif" ref="gac0df443b0046c634bfda75cca75fe0e6" args="(label, expr, errcode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define msg_err_rcif</td>
          <td>(</td>
          <td class="paramtype">label, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">expr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">errcode&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;do { msg_ifb(label, expr) { rc = errcode; goto err;} } while(0)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Log a message of type <code>label</code> if <code>expr</code> is true, set variable <code>rc</code> to <code>errcode</code> and jump to label <code>err</code>. Both <code>rc</code> and <code>err</code> must be in-scope. The <code>expr</code> text statement will be written to the log file.</p>
<p>For example: </p>
<div class="fragment"><pre class="fragment">  <span class="keywordtype">int</span> rc = ERR_NONE;
  ...
  dbg_err_rcif ((madp = <a class="code" href="group__alloc.html#gad508e24d765a79bd7e15feade062407c" title="Alloc a contiguous region of sz bytes and zero-fill it.">u_zalloc</a>(UINT_MAX)) == NULL, ERR_MEM);
  ...
  err:
      <span class="keywordflow">return</span> rc;
</pre></div> 
<p>Definition at line <a class="el" href="carpal_8h_source.html#l00277">277</a> of file <a class="el" href="carpal_8h_source.html">carpal.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga544a28cd51a330c6ad634f38ee313801"></a><!-- doxytag: member="carpal.h::msg_err_sif" ref="ga544a28cd51a330c6ad634f38ee313801" args="(label, expr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define msg_err_sif</td>
          <td>(</td>
          <td class="paramtype">label, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">expr&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;do { if(expr) { msg_noargs(label, errno, #expr); goto err; } } while(0)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Log a message of type <code>label</code> if <code>expr</code> is true and <code>goto</code> to the label <code>err</code> (that must be in-scope). Also logs <code>strerror(errno)</code>.</p>
<p>For example: </p>
<div class="fragment"><pre class="fragment">      dbg_err_sif ((s = <a class="code" href="group__misc.html#gae52a8784cc2099cbe1d700557daec2a6" title="Allocate sufficient memory for a copy of the supplied string, copy it, and return...">u_strdup</a>(huge_string)) == NULL);
      ...
  err:
      <span class="keywordflow">return</span> ~0;
</pre></div> 
<p>Definition at line <a class="el" href="carpal_8h_source.html#l00314">314</a> of file <a class="el" href="carpal_8h_source.html">carpal.h</a>.</p>

</div>
</div>
<a class="anchor" id="gad2505c49f0a40f08bdb8ceb6dd2854f7"></a><!-- doxytag: member="carpal.h::msg_err_sifm" ref="gad2505c49f0a40f08bdb8ceb6dd2854f7" args="(label, expr,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define msg_err_sifm</td>
          <td>(</td>
          <td class="paramtype">label, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">expr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"> <em>...</em>&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;do { if((expr)) { msg(label, errno, __VA_ARGS__);  goto err; } } while(0)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Log the user provided message of type <code>label</code> if <code>expr</code> is true, log <code>strerror(errno)</code> and <code>goto</code> to the label <code>err</code> (that must be in-scope).</p>
<p>For example: </p>
<div class="fragment"><pre class="fragment">      dbg_err_sifm ((fp = fopen(path, <span class="stringliteral">&quot;r&quot;</span>)) == NULL, <span class="stringliteral">&quot;%s&quot;</span>, path);
      ...
  err:
      <span class="keywordflow">return</span> ~0;
</pre></div> 
<p>Definition at line <a class="el" href="carpal_8h_source.html#l00332">332</a> of file <a class="el" href="carpal_8h_source.html">carpal.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga082a1ce6f49d9aec3b205c4db01520c4"></a><!-- doxytag: member="carpal.h::msg_goto_if" ref="ga082a1ce6f49d9aec3b205c4db01520c4" args="(label, expr, gt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define msg_goto_if</td>
          <td>(</td>
          <td class="paramtype">label, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">expr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gt&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;msg_ifb(label, expr) goto gt</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Log a message of type <code>label</code> if <code>expr</code> is not zero and <code>goto</code> to the label <code>gt</code> (that must be in-scope). The <code>expr</code> text statement will be written to the log file.</p>
<p>For example: </p>
<div class="fragment"><pre class="fragment">      again:
          ad = accept(sd, addr, addrlen);
          nop_goto_if (ad == -1 &amp;&amp; errno == EINTR, again);
</pre></div> 
<p>Definition at line <a class="el" href="carpal_8h_source.html#l00237">237</a> of file <a class="el" href="carpal_8h_source.html">carpal.h</a>.</p>

</div>
</div>
<a class="anchor" id="gab805a13efce03fef1b7cbdd525bc7216"></a><!-- doxytag: member="carpal.h::msg_if" ref="gab805a13efce03fef1b7cbdd525bc7216" args="(label, expr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define msg_if</td>
          <td>(</td>
          <td class="paramtype">label, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">expr&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;do { if( expr ) msg_noargs(label, 0, #expr); } while(0)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Log a message of type <code>label</code> if <code>expr</code> is true. The <code>expr</code> text statement will be written to the log file.</p>
<p>For example: </p>
<div class="fragment"><pre class="fragment">      warn_if (check(abc) &lt; 0);
</pre></div> 
<p>Definition at line <a class="el" href="carpal_8h_source.html#l00128">128</a> of file <a class="el" href="carpal_8h_source.html">carpal.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga2757d0c14bd2caa556c52e054fcd2afd"></a><!-- doxytag: member="carpal.h::msg_ifb" ref="ga2757d0c14bd2caa556c52e054fcd2afd" args="(label, expr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define msg_ifb</td>
          <td>(</td>
          <td class="paramtype">label, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">expr&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;if( (expr) &amp;&amp; (msg_noargs(label, 0, #expr) ? 1 : 1) )</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Log a message of type <code>label</code> if <code>expr</code> is true and enter the following if-block. The <code>expr</code> text statement will be written to the log file.</p>
<p>A C-style code block should follow. For example: </p>
<div class="fragment"><pre class="fragment">      dbg_ifb (i == 0)
      {
          statement;
          another_statement;
      }
</pre></div> 
<p>Definition at line <a class="el" href="carpal_8h_source.html#l00160">160</a> of file <a class="el" href="carpal_8h_source.html">carpal.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga62bfdd64e0a9d27b1d993ec575b7cc44"></a><!-- doxytag: member="carpal.h::msg_ifm" ref="ga62bfdd64e0a9d27b1d993ec575b7cc44" args="(label, expr,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define msg_ifm</td>
          <td>(</td>
          <td class="paramtype">label, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">expr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"> <em>...</em>&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;do { if(expr) { msg(label, 0, __VA_ARGS__); } } while(0);</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Log the given message of type <code>label</code> if <em>expr</em> is true.</p>
<p>For example: </p>
<div class="fragment"><pre class="fragment">      warn_ifm (check(abc) &lt; 0, <span class="stringliteral">&quot;check failed on file %s&quot;</span>, filename);
</pre></div> 
<p>Definition at line <a class="el" href="carpal_8h_source.html#l00141">141</a> of file <a class="el" href="carpal_8h_source.html">carpal.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga5bfb7bc6efa849511df25ddc306852f9"></a><!-- doxytag: member="carpal.h::msg_return_if" ref="ga5bfb7bc6efa849511df25ddc306852f9" args="(label, expr, err)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define msg_return_if</td>
          <td>(</td>
          <td class="paramtype">label, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">expr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">err&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;msg_ifb(label, expr) { return err; }</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Log a message if <code>expr</code> is true and <code>return</code> with <code>err</code> to the caller. The <code>expr</code> text statement will be written to the log file.</p>
<p>For example: </p>
<div class="fragment"><pre class="fragment">      <span class="comment">// return with PRM_ERROR if input parameter validation fails</span>
      dbg_return_if (param1 == NULL, PRM_ERROR);
</pre></div> 
<p>Definition at line <a class="el" href="carpal_8h_source.html#l00175">175</a> of file <a class="el" href="carpal_8h_source.html">carpal.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga4f38f94bff9d88bdc55d8a14e2cda238"></a><!-- doxytag: member="carpal.h::msg_return_ifm" ref="ga4f38f94bff9d88bdc55d8a14e2cda238" args="(label, expr, err,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define msg_return_ifm</td>
          <td>(</td>
          <td class="paramtype">label, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">expr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">err, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"> <em>...</em>&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;if(expr) { msg(label, 0, __VA_ARGS__); return err; }</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Log the given message if <code>expr</code> is true and return <code>err</code> to the caller.</p>
<p>For example: </p>
<div class="fragment"><pre class="fragment">      dbg_return_ifm (prm == NULL, PRM_ERROR, <span class="stringliteral">&quot;param %d must be not NULL&quot;</span>, i);
</pre></div> 
<p>Definition at line <a class="el" href="carpal_8h_source.html#l00188">188</a> of file <a class="el" href="carpal_8h_source.html">carpal.h</a>.</p>

</div>
</div>
<a class="anchor" id="gad3d59576732645bbbaf993bc514946d1"></a><!-- doxytag: member="carpal.h::msg_return_sif" ref="gad3d59576732645bbbaf993bc514946d1" args="(label, expr, err)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define msg_return_sif</td>
          <td>(</td>
          <td class="paramtype">label, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">expr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">err&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;do { if(expr) { msg_noargs(label, errno, #expr); return err; } } while(0)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Log a message plus <code>strerror(errno)</code> if <code>expr</code> is true, and return <code>err</code> to the caller. The <code>expr</code> text statement will be written to the log file.</p>
<p>For example: </p>
<div class="fragment"><pre class="fragment">      <span class="comment">// return with ~0 and log errno returned by stat(2)</span>
      warn_return_sif (stat(filename, &amp;sb) == -1, ~0);
</pre></div> 
<p>Definition at line <a class="el" href="carpal_8h_source.html#l00220">220</a> of file <a class="el" href="carpal_8h_source.html">carpal.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga833c0608c6146af8e6a74926c66868b0"></a><!-- doxytag: member="carpal.h::msg_return_sifm" ref="ga833c0608c6146af8e6a74926c66868b0" args="(label, expr, err,...)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define msg_return_sifm</td>
          <td>(</td>
          <td class="paramtype">label, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">expr, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">err, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"> <em>...</em>&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;if(expr) { msg(label, errno, __VA_ARGS__); return err; }</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Log the given message plus <code>strerror(errno)</code> if <code>expr</code> is true, and return <code>err</code> to the caller.</p>
<p>For example: </p>
<div class="fragment"><pre class="fragment">      dbg_return_sifm (stat(fn, &amp;st) == -1, -1, <span class="stringliteral">&quot;file %s access error&quot;</span>, fn);
</pre></div> 
<p>Definition at line <a class="el" href="carpal_8h_source.html#l00203">203</a> of file <a class="el" href="carpal_8h_source.html">carpal.h</a>.</p>

</div>
</div>
<a class="anchor" id="gadced23755fa8b6d7423e8499318a1801"></a><!-- doxytag: member="carpal.h::msg_strerror" ref="gadced23755fa8b6d7423e8499318a1801" args="(label, en)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define msg_strerror</td>
          <td>(</td>
          <td class="paramtype">label, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">en&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><span class="keywordflow">do</span> {                                                            \
        <span class="keyword">enum</span> { _DBG_BUFSZ = 256 };                                  \
        <span class="keywordtype">char</span> _eb[_DBG_BUFSZ] = { 0 };                               \
        <span class="keywordflow">if</span>(<a class="code" href="group__log.html#ga646c6a2971a57046f929a624134969af" title="Return, in the given buffer, a string describing the error code.">u_strerror_r</a>(en, _eb, _DBG_BUFSZ)) {                     \
            msg(label, 0, <span class="stringliteral">&quot;strerror_r(%d, ...) failed&quot;</span>, en);        \
        } <span class="keywordflow">else</span> {                                                    \
            msg(label, 0, <span class="stringliteral">&quot;errno: %d (%s)&quot;</span>, errno, _eb);            \
        }                                                           \
    } <span class="keywordflow">while</span>(0)
</pre></div><p>For example: </p>
<div class="fragment"><pre class="fragment">      <span class="keywordflow">switch</span> (inet_pton(AF_INET6, host, &amp;sin6-&gt;sin6_addr))
      {
          <span class="keywordflow">case</span> -1:
              dbg_strerror(errno);
              <span class="comment">// fall through</span>
      ...
</pre></div> 
<p>Definition at line <a class="el" href="carpal_8h_source.html#l00364">364</a> of file <a class="el" href="carpal_8h_source.html">carpal.h</a>.</p>

</div>
</div>
</div>
<hr>
<div>
  <div style="text-align:left">
    <a href="http://www.koanlogic.com/products.html">&larr;Products</a>
  </div>
  <div style="text-align:center;">
    &copy; 2005-2012 - <a href="http://www.koanlogic.com">KoanLogic S.r.l.</a> - All rights reserved
  </div>
</div>

</body>
</html>
