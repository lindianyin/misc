<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>LibU: Priority Queues</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Intro</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Priority Queues</h1><hr/><a name="_details"></a><h2>Overview</h2>
<p>The <a class="el" href="group__pq.html">Priority Queues</a> module implements a fixed length priority queue using a heap. Elements (together with their associated numerical priority) are pushed to the queue via (<a class="el" href="group__pq.html#ga863b44af8df6e1ba0ff515646393697b" title="Push an element with the given priority.">u_pq_push</a>) until free slots are available.</p>
<p>The top element can be evicted (<a class="el" href="group__pq.html#ga77378df9d3140e6a84b386f685087f1a" title="Evict the top element from the supplied queue.">u_pq_delmax</a>) or just peeked at (<a class="el" href="group__pq.html#ga05601ec35cfdcc8a7e684ed56976e5e6" title="Return the top element without evicting it.">u_pq_peekmax</a>). Eviction and insertion are performed in O(lg(N)) where N is the queue cardinality.</p>
<p>The following example describes the use of a priority queue to efficiently extract the bottom 10 out of 10 million random values: </p>
<div class="fragment"><pre class="fragment">    {
        <span class="keyword">enum</span> { EMAX = 10 };
        <span class="keywordtype">size_t</span> i;
        <span class="keywordtype">double</span> key, keymax = DBL_MAX;
        <a class="code" href="group__pq.html#ga8c42ee378682d9a39d308f42614fde55" title="The priority queue handler.">u_pq_t</a> *pq = NULL;

        srandom((<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>) getpid());

        con_err_if (<a class="code" href="group__pq.html#ga019a71d089464a93dfe7b236a5119d36" title="Create a new priority queue.">u_pq_create</a>(EMAX, &amp;pq));

        <span class="comment">// fill the pqueue </span>
        <span class="keywordflow">for</span> (i = 0; i &lt; EMAX; i++)
            con_err_if (<a class="code" href="group__pq.html#ga863b44af8df6e1ba0ff515646393697b" title="Push an element with the given priority.">u_pq_push</a>(pq, (<span class="keywordtype">double</span>) random(), NULL));

        <span class="comment">// del-push cycle</span>
        <span class="keywordflow">for</span> (i = EMAX; i &lt; 10000000; i++)
        {
            (void) <a class="code" href="group__pq.html#ga05601ec35cfdcc8a7e684ed56976e5e6" title="Return the top element without evicting it.">u_pq_peekmax</a>(pq, &amp;keymax);

            <span class="keywordflow">if</span> (keymax &gt; (key = (<span class="keywordtype">double</span>) random()))
            {
                (void) <a class="code" href="group__pq.html#ga77378df9d3140e6a84b386f685087f1a" title="Evict the top element from the supplied queue.">u_pq_delmax</a>(pq, NULL);
                con_err_if (<a class="code" href="group__pq.html#ga863b44af8df6e1ba0ff515646393697b" title="Push an element with the given priority.">u_pq_push</a>(pq, key, NULL));
            }
        }

        <span class="comment">// print results</span>
        <span class="keywordflow">for</span> (i = 0; !<a class="code" href="group__pq.html#gae585aa69b81fd9ecc5cea55e74abe128" title="Tell if a the supplied queue is empty.">u_pq_empty</a>(pq); i++)
        {
            (void) <a class="code" href="group__pq.html#ga77378df9d3140e6a84b386f685087f1a" title="Evict the top element from the supplied queue.">u_pq_delmax</a>(pq, &amp;key);
            u_con(<span class="stringliteral">&quot;%zu: %.0lf&quot;</span>, EMAX - i, key);
        }
    }
</pre></div> <table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga8c42ee378682d9a39d308f42614fde55"></a><!-- doxytag: member="pq::u_pq_t" ref="ga8c42ee378682d9a39d308f42614fde55" args="" -->
typedef struct u_pq_s&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pq.html#ga8c42ee378682d9a39d308f42614fde55">u_pq_t</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The priority queue handler. <br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pq.html#ga019a71d089464a93dfe7b236a5119d36">u_pq_create</a> (size_t nitems, <a class="el" href="group__pq.html#ga8c42ee378682d9a39d308f42614fde55">u_pq_t</a> **ppq)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a new priority queue.  <a href="#ga019a71d089464a93dfe7b236a5119d36"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pq.html#ga863b44af8df6e1ba0ff515646393697b">u_pq_push</a> (<a class="el" href="group__pq.html#ga8c42ee378682d9a39d308f42614fde55">u_pq_t</a> *pq, double key, const void *val)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Push an element with the given priority.  <a href="#ga863b44af8df6e1ba0ff515646393697b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pq.html#ga77378df9d3140e6a84b386f685087f1a">u_pq_delmax</a> (<a class="el" href="group__pq.html#ga8c42ee378682d9a39d308f42614fde55">u_pq_t</a> *pq, double *pkey)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Evict the top element from the supplied queue.  <a href="#ga77378df9d3140e6a84b386f685087f1a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pq.html#ga05601ec35cfdcc8a7e684ed56976e5e6">u_pq_peekmax</a> (<a class="el" href="group__pq.html#ga8c42ee378682d9a39d308f42614fde55">u_pq_t</a> *pq, double *pkey)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the top element without evicting it.  <a href="#ga05601ec35cfdcc8a7e684ed56976e5e6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pq.html#gae585aa69b81fd9ecc5cea55e74abe128">u_pq_empty</a> (<a class="el" href="group__pq.html#ga8c42ee378682d9a39d308f42614fde55">u_pq_t</a> *pq)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Tell if a the supplied queue is empty.  <a href="#gae585aa69b81fd9ecc5cea55e74abe128"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pq.html#ga06f25881f9a8339352737ddfe73018f9">u_pq_full</a> (<a class="el" href="group__pq.html#ga8c42ee378682d9a39d308f42614fde55">u_pq_t</a> *pq)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Tell if a the supplied queue is full.  <a href="#ga06f25881f9a8339352737ddfe73018f9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pq.html#ga02cb72cb95a8a1137a8b16ab64819f65">u_pq_free</a> (<a class="el" href="group__pq.html#ga8c42ee378682d9a39d308f42614fde55">u_pq_t</a> *pq)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Dispose the queue.  <a href="#ga02cb72cb95a8a1137a8b16ab64819f65"></a><br/></td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga019a71d089464a93dfe7b236a5119d36"></a><!-- doxytag: member="pqueue.h::u_pq_create" ref="ga019a71d089464a93dfe7b236a5119d36" args="(size_t nitems, u_pq_t **ppq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int u_pq_create </td>
          <td>(</td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>nitems</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__pq.html#ga8c42ee378682d9a39d308f42614fde55">u_pq_t</a> **&nbsp;</td>
          <td class="paramname"> <em>ppq</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Create a new u_u_pq_t object with <code>nitems</code> elements and return its reference as a result value at <code>*ppq</code> </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>nitems</em>&nbsp;</td><td>maximum number of elements (at least 2) in queue </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ppq</em>&nbsp;</td><td>the newly created u_u_pq_t object as a result argument</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>~0</em>&nbsp;</td><td>on failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="srcs_2toolbox_2pqueue_8c_source.html#l00089">89</a> of file <a class="el" href="srcs_2toolbox_2pqueue_8c_source.html">srcs/toolbox/pqueue.c</a>.</p>

<p>References <a class="el" href="memory_8c_source.html#l00067">u_calloc()</a>, <a class="el" href="srcs_2toolbox_2pqueue_8c_source.html#l00146">u_pq_free()</a>, and <a class="el" href="memory_8c_source.html#l00073">u_zalloc()</a>.</p>

</div>
</div>
<a class="anchor" id="ga77378df9d3140e6a84b386f685087f1a"></a><!-- doxytag: member="pqueue.h::u_pq_delmax" ref="ga77378df9d3140e6a84b386f685087f1a" args="(u_pq_t *pq, double *pkey)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * u_pq_delmax </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__pq.html#ga8c42ee378682d9a39d308f42614fde55">u_pq_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>pkey</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pq</em>&nbsp;</td><td>an <a class="el" href="group__pq.html#ga8c42ee378682d9a39d308f42614fde55" title="The priority queue handler.">u_pq_t</a> object </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pkey</em>&nbsp;</td><td>if non-NULL, it will store the priority of the top element</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the evicted element value</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>If performed on an empty queue the result is unpredictable. </dd></dl>

<p>Definition at line <a class="el" href="srcs_2toolbox_2pqueue_8c_source.html#l00226">226</a> of file <a class="el" href="srcs_2toolbox_2pqueue_8c_source.html">srcs/toolbox/pqueue.c</a>.</p>

</div>
</div>
<a class="anchor" id="gae585aa69b81fd9ecc5cea55e74abe128"></a><!-- doxytag: member="pqueue.h::u_pq_empty" ref="gae585aa69b81fd9ecc5cea55e74abe128" args="(u_pq_t *pq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int u_pq_empty </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__pq.html#ga8c42ee378682d9a39d308f42614fde55">u_pq_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pq</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pq</em>&nbsp;</td><td>queue handler</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><code>0</code> when there is some element in <code>pq</code>, non-zero otherwise. </dd></dl>

<p>Definition at line <a class="el" href="srcs_2toolbox_2pqueue_8c_source.html#l00120">120</a> of file <a class="el" href="srcs_2toolbox_2pqueue_8c_source.html">srcs/toolbox/pqueue.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga02cb72cb95a8a1137a8b16ab64819f65"></a><!-- doxytag: member="pqueue.h::u_pq_free" ref="ga02cb72cb95a8a1137a8b16ab64819f65" args="(u_pq_t *pq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void u_pq_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__pq.html#ga8c42ee378682d9a39d308f42614fde55">u_pq_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pq</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Dispose the supplied <a class="el" href="group__pq.html#ga8c42ee378682d9a39d308f42614fde55" title="The priority queue handler.">u_pq_t</a> object <code>q</code> </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pq</em>&nbsp;</td><td>a previously allocated <a class="el" href="group__pq.html#ga8c42ee378682d9a39d308f42614fde55" title="The priority queue handler.">u_pq_t</a> object</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>nothing </dd></dl>

<p>Definition at line <a class="el" href="srcs_2toolbox_2pqueue_8c_source.html#l00146">146</a> of file <a class="el" href="srcs_2toolbox_2pqueue_8c_source.html">srcs/toolbox/pqueue.c</a>.</p>

<p>References <a class="el" href="memory_8c_source.html#l00085">u_free()</a>.</p>

<p>Referenced by <a class="el" href="srcs_2toolbox_2pqueue_8c_source.html#l00089">u_pq_create()</a>.</p>

</div>
</div>
<a class="anchor" id="ga06f25881f9a8339352737ddfe73018f9"></a><!-- doxytag: member="pqueue.h::u_pq_full" ref="ga06f25881f9a8339352737ddfe73018f9" args="(u_pq_t *pq)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int u_pq_full </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__pq.html#ga8c42ee378682d9a39d308f42614fde55">u_pq_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pq</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pq</em>&nbsp;</td><td>queue handler</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><code>0</code> when there is no room left in <code>pq</code>, non-zero otherwise. </dd></dl>

<p>Definition at line <a class="el" href="srcs_2toolbox_2pqueue_8c_source.html#l00132">132</a> of file <a class="el" href="srcs_2toolbox_2pqueue_8c_source.html">srcs/toolbox/pqueue.c</a>.</p>

<p>Referenced by <a class="el" href="srcs_2toolbox_2pqueue_8c_source.html#l00171">u_pq_push()</a>.</p>

</div>
</div>
<a class="anchor" id="ga05601ec35cfdcc8a7e684ed56976e5e6"></a><!-- doxytag: member="pqueue.h::u_pq_peekmax" ref="ga05601ec35cfdcc8a7e684ed56976e5e6" args="(u_pq_t *pq, double *pkey)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * u_pq_peekmax </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__pq.html#ga8c42ee378682d9a39d308f42614fde55">u_pq_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&nbsp;</td>
          <td class="paramname"> <em>pkey</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pq</em>&nbsp;</td><td>an <a class="el" href="group__pq.html#ga8c42ee378682d9a39d308f42614fde55" title="The priority queue handler.">u_pq_t</a> object </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pkey</em>&nbsp;</td><td>if non-NULL, it will store the priority of the top element</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the element value</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>If performed on an empty queue the result is unpredictable. </dd></dl>

<p>Definition at line <a class="el" href="srcs_2toolbox_2pqueue_8c_source.html#l00206">206</a> of file <a class="el" href="srcs_2toolbox_2pqueue_8c_source.html">srcs/toolbox/pqueue.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga863b44af8df6e1ba0ff515646393697b"></a><!-- doxytag: member="pqueue.h::u_pq_push" ref="ga863b44af8df6e1ba0ff515646393697b" args="(u_pq_t *pq, double key, const void *val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int u_pq_push </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__pq.html#ga8c42ee378682d9a39d308f42614fde55">u_pq_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>val</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Push the element <code>val</code> into the <a class="el" href="group__pq.html#ga8c42ee378682d9a39d308f42614fde55" title="The priority queue handler.">u_pq_t</a> object <code>pq</code> with the given priority <code>key</code> </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pq</em>&nbsp;</td><td>an <a class="el" href="group__pq.html#ga8c42ee378682d9a39d308f42614fde55" title="The priority queue handler.">u_pq_t</a> object </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>key</em>&nbsp;</td><td>the priority tag for <code>ptr</code> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>val</em>&nbsp;</td><td>the element to be pushed into <code>q</code> </td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-1</em>&nbsp;</td><td>on failure </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>-2</em>&nbsp;</td><td>if the insertion can't proceed because the queue is full </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="srcs_2toolbox_2pqueue_8c_source.html#l00171">171</a> of file <a class="el" href="srcs_2toolbox_2pqueue_8c_source.html">srcs/toolbox/pqueue.c</a>.</p>

<p>References <a class="el" href="srcs_2toolbox_2pqueue_8c_source.html#l00132">u_pq_full()</a>.</p>

</div>
</div>
</div>
<hr>
<div>
  <div style="text-align:left">
    <a href="http://www.koanlogic.com/products.html">&larr;Products</a>
  </div>
  <div style="text-align:center;">
    &copy; 2005-2012 - <a href="http://www.koanlogic.com">KoanLogic S.r.l.</a> - All rights reserved
  </div>
</div>

</body>
</html>
