<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>LibU: Password</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Intro</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>Password</h1><hr/><a name="_details"></a><h2>Overview</h2>
<p>The <a class="el" href="group__pwd.html">Password</a> module models the interface to a generic credential storage device which is password based. An <a class="el" href="group__pwd.html#ga95bdb8d39873ee3b16a27fd3665ea41c" title="default length of a password file line (can be changed at compile time via -DU_PWD_LINE_MAX=nnn...">u_pwd_t</a> object is the handler through which all authentication and retrieval operations are performed over a given password DB. A password storage collects a number of identical records which carry at least an username and related password, plus an optional opaque blob which is intended to transport application specific information. Each of such records is mediated by the <a class="el" href="group__pwd.html#gad545d5fc0c65eb34fba6713d3ae430fc" title="Carry information about a single password DB record.">u_pwd_rec_t</a> object. The storage is abstracted by means of a brigade of callbacks that the programmer is supposed to supply to the <a class="el" href="group__pwd.html#ga2a6beedb54f220e5930524c3eb620e62" title="Initialize a pwd instance.">u_pwd_init</a> function. A specialization of such function is provided for file based password files as <a class="el" href="group__pwd.html#gad3f849da69ab6f3aae9aa915d4a71699" title="Init specialization for file-based password db.">u_pwd_init_file</a>.</p>
<p>A simple authenticator based on the <a class="el" href="group__pwd.html">Password</a> module follows: </p>
<div class="fragment"><pre class="fragment">    <span class="keywordtype">int</span> main (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])
    {
        <span class="keywordtype">char</span> c;
        <span class="keywordtype">int</span> i, rc, in_memory = 0;
        <a class="code" href="group__pwd.html#ga95bdb8d39873ee3b16a27fd3665ea41c" title="default length of a password file line (can be changed at compile time via -DU_PWD_LINE_MAX=nnn...">u_pwd_t</a> *pwd = NULL;
        <span class="keywordtype">char</span> prompt[128];

        <span class="keywordflow">while</span> ((c = getopt(argc, argv, <span class="stringliteral">&quot;m&quot;</span>)) != -1)
        {
            <span class="keywordflow">switch</span> (c)
            {
                <span class="keywordflow">case</span> <span class="charliteral">&#39;m&#39;</span>:
                    ++in_memory;
                    <span class="keywordflow">break</span>;
                <span class="keywordflow">default</span>:
                    con_err(<span class="stringliteral">&quot;usage: pwd [-m] user ...&quot;</span>);
            }
        }

        argc -= optind;
        argv += optind;

        con_err_if (<a class="code" href="group__pwd.html#gad3f849da69ab6f3aae9aa915d4a71699" title="Init specialization for file-based password db.">u_pwd_init_file</a>(<span class="stringliteral">&quot;./passwd&quot;</span>, NULL, 0, in_memory, &amp;pwd));

        <span class="keywordflow">for</span> (i = 0; i &lt; argc; i++)
        {
            (void) <a class="code" href="group__misc.html#ga1a0e41b455f71373a2ded5d9dfc52572" title="snprintf(3) wrapper">u_snprintf</a>(prompt, <span class="keyword">sizeof</span> prompt, <span class="stringliteral">&quot;%s: &quot;</span>, argv[i]);
            rc = <a class="code" href="group__pwd.html#ga16135e4c199535789903d4284a183f5f" title="Check if user has presented the right credential.">u_pwd_auth_user</a>(pwd, argv[i], getpass(prompt));
            u_con(<span class="stringliteral">&quot;auth %s&quot;</span>, rc ? <span class="stringliteral">&quot;failed&quot;</span> : <span class="stringliteral">&quot;ok&quot;</span>);
        }

        <a class="code" href="group__pwd.html#ga953feb369ad87ac17aaca82541085c21" title="Dispose the supplied pwd instance.">u_pwd_term</a>(pwd);

        <span class="keywordflow">return</span> EXIT_SUCCESS;
    err:
        <span class="keywordflow">return</span> EXIT_FAILURE;
    }
</pre></div><p>Where the passwd file structure can be as simple as: </p>
<div class="fragment"><pre class="fragment"><span class="preprocessor">    # &quot;name&quot;:&quot;password&quot;[:&quot;hint&quot;]</span>
<span class="preprocessor"></span>    jake:joliet:blues
    steve:colonel:cropper
    donald:duck:dunn
</pre></div><p> Note that the password field is in clear-text: in fact there was no hash callback supplied to the <a class="el" href="group__pwd.html#gad3f849da69ab6f3aae9aa915d4a71699" title="Init specialization for file-based password db.">u_pwd_init_file</a> function. </p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct u_pwd_s&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pwd.html#ga95bdb8d39873ee3b16a27fd3665ea41c">u_pwd_t</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">default length of a password file line (can be changed at compile time via <code>-DU_PWD_LINE_MAX=nnn</code> flag)  <a href="#ga95bdb8d39873ee3b16a27fd3665ea41c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gad545d5fc0c65eb34fba6713d3ae430fc"></a><!-- doxytag: member="pwd::u_pwd_rec_t" ref="gad545d5fc0c65eb34fba6713d3ae430fc" args="" -->
typedef struct u_pwd_rec_s&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pwd.html#gad545d5fc0c65eb34fba6713d3ae430fc">u_pwd_rec_t</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Carry information about a single password DB record. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga43eb981a4bdb2ef01de7c098af811839"></a><!-- doxytag: member="pwd::u_pwd_hash_cb_t" ref="ga43eb981a4bdb2ef01de7c098af811839" args=")(const char *, size_t, char[])" -->
typedef int(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pwd.html#ga43eb981a4bdb2ef01de7c098af811839">u_pwd_hash_cb_t</a> )(const char *, size_t, char[])</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Password hashing callback prototype: accept a string and its lenght, return the hashed string. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga0066b6c90ef073817e84c5f5ab275f8d"></a><!-- doxytag: member="pwd::u_pwd_load_cb_t" ref="ga0066b6c90ef073817e84c5f5ab275f8d" args=")(char *, int, void *)" -->
typedef char *(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pwd.html#ga0066b6c90ef073817e84c5f5ab275f8d">u_pwd_load_cb_t</a> )(char *, int, void *)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Record load callback prototype: has fgets(3)-like prototype with generic storage resource handler. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga30b3b0ecdad300ae09f8a22747912ab8"></a><!-- doxytag: member="pwd::u_pwd_open_cb_t" ref="ga30b3b0ecdad300ae09f8a22747912ab8" args=")(const char *, void **)" -->
typedef int(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pwd.html#ga30b3b0ecdad300ae09f8a22747912ab8">u_pwd_open_cb_t</a> )(const char *, void **)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Master password DB open callback prototype: accepts an uri, return the (opaque) resource handler - the same that will be supplied to the <a class="el" href="group__pwd.html#ga0066b6c90ef073817e84c5f5ab275f8d" title="Record load callback prototype: has fgets(3)-like prototype with generic storage...">u_pwd_load_cb_t</a>. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="gaf5bd888cbff6cd0a1da01907e0069084"></a><!-- doxytag: member="pwd::u_pwd_notify_cb_t" ref="gaf5bd888cbff6cd0a1da01907e0069084" args=")(const char *, time_t, time_t *)" -->
typedef int(*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pwd.html#gaf5bd888cbff6cd0a1da01907e0069084">u_pwd_notify_cb_t</a> )(const char *, time_t, time_t *)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update notification callback prototype: return true if supplied timestamp is older than last modification time (this will force a reload for in-memory password DBs). <br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pwd.html#ga2a6beedb54f220e5930524c3eb620e62">u_pwd_init</a> (const char *res_uri, <a class="el" href="group__pwd.html#ga30b3b0ecdad300ae09f8a22747912ab8">u_pwd_open_cb_t</a> cb_open, <a class="el" href="group__pwd.html#ga0066b6c90ef073817e84c5f5ab275f8d">u_pwd_load_cb_t</a> cb_load, u_pwd_close_cb_t cb_close, <a class="el" href="group__pwd.html#gaf5bd888cbff6cd0a1da01907e0069084">u_pwd_notify_cb_t</a> cb_notify, <a class="el" href="group__pwd.html#ga43eb981a4bdb2ef01de7c098af811839">u_pwd_hash_cb_t</a> cb_hash, size_t hash_len, int in_memory, <a class="el" href="group__pwd.html#ga95bdb8d39873ee3b16a27fd3665ea41c">u_pwd_t</a> **ppwd)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize a pwd instance.  <a href="#ga2a6beedb54f220e5930524c3eb620e62"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pwd.html#ga9a1d5d9462850ec60a46e44bdba43b19">u_pwd_retr</a> (<a class="el" href="group__pwd.html#ga95bdb8d39873ee3b16a27fd3665ea41c">u_pwd_t</a> *pwd, const char *user, <a class="el" href="group__pwd.html#gad545d5fc0c65eb34fba6713d3ae430fc">u_pwd_rec_t</a> **prec)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieve a pwd record.  <a href="#ga9a1d5d9462850ec60a46e44bdba43b19"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pwd.html#ga16135e4c199535789903d4284a183f5f">u_pwd_auth_user</a> (<a class="el" href="group__pwd.html#ga95bdb8d39873ee3b16a27fd3665ea41c">u_pwd_t</a> *pwd, const char *user, const char *password)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check if user has presented the right credential.  <a href="#ga16135e4c199535789903d4284a183f5f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pwd.html#ga953feb369ad87ac17aaca82541085c21">u_pwd_term</a> (<a class="el" href="group__pwd.html#ga95bdb8d39873ee3b16a27fd3665ea41c">u_pwd_t</a> *pwd)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Dispose the supplied pwd instance.  <a href="#ga953feb369ad87ac17aaca82541085c21"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pwd.html#gad3f849da69ab6f3aae9aa915d4a71699">u_pwd_init_file</a> (const char *res_uri, <a class="el" href="group__pwd.html#ga43eb981a4bdb2ef01de7c098af811839">u_pwd_hash_cb_t</a> cb_hash, size_t hash_len, int in_memory, <a class="el" href="group__pwd.html#ga95bdb8d39873ee3b16a27fd3665ea41c">u_pwd_t</a> **ppwd)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Init specialization for file-based password db.  <a href="#gad3f849da69ab6f3aae9aa915d4a71699"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pwd.html#ga05ce71b28ee2271281fe4efcbfd6675e">u_pwd_rec_free</a> (<a class="el" href="group__pwd.html#ga95bdb8d39873ee3b16a27fd3665ea41c">u_pwd_t</a> *pwd, <a class="el" href="group__pwd.html#gad545d5fc0c65eb34fba6713d3ae430fc">u_pwd_rec_t</a> *rec)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Dispose a <a class="el" href="group__pwd.html#gad545d5fc0c65eb34fba6713d3ae430fc" title="Carry information about a single password DB record.">u_pwd_rec_t</a> object.  <a href="#ga05ce71b28ee2271281fe4efcbfd6675e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pwd.html#ga5f2e179fad8d591ed47ab1a6fe65e9a6">u_pwd_rec_get_user</a> (<a class="el" href="group__pwd.html#gad545d5fc0c65eb34fba6713d3ae430fc">u_pwd_rec_t</a> *rec)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the user field of the supplied pwd record.  <a href="#ga5f2e179fad8d591ed47ab1a6fe65e9a6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pwd.html#ga7ac6de19c0c3e4e19ddaad68de295eda">u_pwd_rec_get_password</a> (<a class="el" href="group__pwd.html#gad545d5fc0c65eb34fba6713d3ae430fc">u_pwd_rec_t</a> *rec)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the password field of the supplied pwd record.  <a href="#ga7ac6de19c0c3e4e19ddaad68de295eda"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pwd.html#ga763ca1a183471a7c47e8c9b964b58fb6">u_pwd_rec_get_opaque</a> (<a class="el" href="group__pwd.html#gad545d5fc0c65eb34fba6713d3ae430fc">u_pwd_rec_t</a> *rec)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the opaque field of the supplied pwd record.  <a href="#ga763ca1a183471a7c47e8c9b964b58fb6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__pwd.html#ga4a2a646a3a22e3dad8d7df677874ec87">u_pwd_in_memory</a> (<a class="el" href="group__pwd.html#ga95bdb8d39873ee3b16a27fd3665ea41c">u_pwd_t</a> *pwd)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the in_memory attribute from the supplied pwd instance.  <a href="#ga4a2a646a3a22e3dad8d7df677874ec87"></a><br/></td></tr>
</table>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="ga95bdb8d39873ee3b16a27fd3665ea41c"></a><!-- doxytag: member="pwd.h::u_pwd_t" ref="ga95bdb8d39873ee3b16a27fd3665ea41c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct u_pwd_s <a class="el" href="group__pwd.html#ga95bdb8d39873ee3b16a27fd3665ea41c">u_pwd_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Base pwd object, mediates all operations over the password DB </p>

<p>Definition at line <a class="el" href="pwd_8h_source.html#l00031">31</a> of file <a class="el" href="pwd_8h_source.html">pwd.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga16135e4c199535789903d4284a183f5f"></a><!-- doxytag: member="srcs/toolbox/pwd.c::u_pwd_auth_user" ref="ga16135e4c199535789903d4284a183f5f" args="(u_pwd_t *pwd, const char *user, const char *password)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int u_pwd_auth_user </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__pwd.html#ga95bdb8d39873ee3b16a27fd3665ea41c">u_pwd_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pwd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>password</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Check if <code>user</code> has presented the right <code>password</code> to access the <a class="el" href="group__pwd.html#ga95bdb8d39873ee3b16a27fd3665ea41c" title="default length of a password file line (can be changed at compile time via -DU_PWD_LINE_MAX=nnn...">u_pwd_t</a> object <code>pwd</code> </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pwd</em>&nbsp;</td><td>an already initialized pwd instance </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>user</em>&nbsp;</td><td>user whose credential has to be checked </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>password</em>&nbsp;</td><td>the supplied credential</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>if authentication is ok </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>~0</em>&nbsp;</td><td>if authentication fails </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="srcs_2toolbox_2pwd_8c_source.html#l00246">246</a> of file <a class="el" href="srcs_2toolbox_2pwd_8c_source.html">srcs/toolbox/pwd.c</a>.</p>

<p>References <a class="el" href="memory_8c_source.html#l00085">u_free()</a>, <a class="el" href="srcs_2toolbox_2pwd_8c_source.html#l00346">u_pwd_rec_free()</a>, <a class="el" href="srcs_2toolbox_2pwd_8c_source.html#l00219">u_pwd_retr()</a>, <a class="el" href="srcs_2toolbox_2misc_8c_source.html#l00203">u_strlcpy()</a>, and <a class="el" href="memory_8c_source.html#l00073">u_zalloc()</a>.</p>

</div>
</div>
<a class="anchor" id="ga4a2a646a3a22e3dad8d7df677874ec87"></a><!-- doxytag: member="srcs/toolbox/pwd.c::u_pwd_in_memory" ref="ga4a2a646a3a22e3dad8d7df677874ec87" args="(u_pwd_t *pwd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int u_pwd_in_memory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__pwd.html#ga95bdb8d39873ee3b16a27fd3665ea41c">u_pwd_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pwd</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the <code>in_memory</code> attribute from the supplied <a class="el" href="group__pwd.html#ga95bdb8d39873ee3b16a27fd3665ea41c" title="default length of a password file line (can be changed at compile time via -DU_PWD_LINE_MAX=nnn...">u_pwd_t</a> object, i.e. the fact that the password DB is memory cached or not.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pwd</em>&nbsp;</td><td>the <a class="el" href="group__pwd.html#ga95bdb8d39873ee3b16a27fd3665ea41c" title="default length of a password file line (can be changed at compile time via -DU_PWD_LINE_MAX=nnn...">u_pwd_t</a> object to be inquired</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>return <code>0</code> in case it is not an in-memory pwd instance </dd></dl>

<p>Definition at line <a class="el" href="srcs_2toolbox_2pwd_8c_source.html#l00417">417</a> of file <a class="el" href="srcs_2toolbox_2pwd_8c_source.html">srcs/toolbox/pwd.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga2a6beedb54f220e5930524c3eb620e62"></a><!-- doxytag: member="srcs/toolbox/pwd.c::u_pwd_init" ref="ga2a6beedb54f220e5930524c3eb620e62" args="(const char *res_uri, u_pwd_open_cb_t cb_open, u_pwd_load_cb_t cb_load, u_pwd_close_cb_t cb_close, u_pwd_notify_cb_t cb_notify, u_pwd_hash_cb_t cb_hash, size_t hash_len, int in_memory, u_pwd_t **ppwd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int u_pwd_init </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>res_uri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__pwd.html#ga30b3b0ecdad300ae09f8a22747912ab8">u_pwd_open_cb_t</a>&nbsp;</td>
          <td class="paramname"> <em>cb_open</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__pwd.html#ga0066b6c90ef073817e84c5f5ab275f8d">u_pwd_load_cb_t</a>&nbsp;</td>
          <td class="paramname"> <em>cb_load</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">u_pwd_close_cb_t&nbsp;</td>
          <td class="paramname"> <em>cb_close</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__pwd.html#gaf5bd888cbff6cd0a1da01907e0069084">u_pwd_notify_cb_t</a>&nbsp;</td>
          <td class="paramname"> <em>cb_notify</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__pwd.html#ga43eb981a4bdb2ef01de7c098af811839">u_pwd_hash_cb_t</a>&nbsp;</td>
          <td class="paramname"> <em>cb_hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>hash_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>in_memory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__pwd.html#ga95bdb8d39873ee3b16a27fd3665ea41c">u_pwd_t</a> **&nbsp;</td>
          <td class="paramname"> <em>ppwd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get a new <a class="el" href="group__pwd.html#ga95bdb8d39873ee3b16a27fd3665ea41c" title="default length of a password file line (can be changed at compile time via -DU_PWD_LINE_MAX=nnn...">u_pwd_t</a> object using the supplied attributes</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>res_uri</em>&nbsp;</td><td>name of the master db resource </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cb_open</em>&nbsp;</td><td>method to open <code>res_uri</code> (get its handler) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cb_load</em>&nbsp;</td><td>method to load <code>res_uri</code> lines one by one </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cb_close</em>&nbsp;</td><td>method to dispose <code>res_uri</code> handler (OPTIONAL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cb_notify</em>&nbsp;</td><td>method to notify changes in the master resource (OPTIONAL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cb_hash</em>&nbsp;</td><td>method to hash passwords (OPTIONAL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>hash_len</em>&nbsp;</td><td>hashed password string length (needed if <code>cb_hash</code> has been set) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in_memory</em>&nbsp;</td><td>if true, keep an hash-map'd version of the master db into memory (useful for huge and static db's) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ppwd</em>&nbsp;</td><td>the pwd instance handler as a result value</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>~0</em>&nbsp;</td><td>on failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="srcs_2toolbox_2pwd_8c_source.html#l00161">161</a> of file <a class="el" href="srcs_2toolbox_2pwd_8c_source.html">srcs/toolbox/pwd.c</a>.</p>

<p>References <a class="el" href="srcs_2toolbox_2pwd_8c_source.html#l00300">u_pwd_term()</a>, <a class="el" href="srcs_2toolbox_2misc_8c_source.html#l00203">u_strlcpy()</a>, and <a class="el" href="memory_8c_source.html#l00073">u_zalloc()</a>.</p>

<p>Referenced by <a class="el" href="srcs_2toolbox_2pwd_8c_source.html#l00327">u_pwd_init_file()</a>.</p>

</div>
</div>
<a class="anchor" id="gad3f849da69ab6f3aae9aa915d4a71699"></a><!-- doxytag: member="srcs/toolbox/pwd.c::u_pwd_init_file" ref="gad3f849da69ab6f3aae9aa915d4a71699" args="(const char *res_uri, u_pwd_hash_cb_t cb_hash, size_t hash_len, int in_memory, u_pwd_t **ppwd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int u_pwd_init_file </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>res_uri</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__pwd.html#ga43eb981a4bdb2ef01de7c098af811839">u_pwd_hash_cb_t</a>&nbsp;</td>
          <td class="paramname"> <em>cb_hash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>hash_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>in_memory</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__pwd.html#ga95bdb8d39873ee3b16a27fd3665ea41c">u_pwd_t</a> **&nbsp;</td>
          <td class="paramname"> <em>ppwd</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>An <a class="el" href="group__pwd.html#ga2a6beedb54f220e5930524c3eb620e62" title="Initialize a pwd instance.">u_pwd_init</a> specialization for file-based password DBs</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>res_uri</em>&nbsp;</td><td>name of the master db resource </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cb_hash</em>&nbsp;</td><td>method to hash passwords (OPTIONAL) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>hash_len</em>&nbsp;</td><td>hashed password string lenght (needed if <code>cb_hash</code> has been set) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>in_memory</em>&nbsp;</td><td>if true, keep an hash-map'd version of the master db into memory (useful for huge and static db's) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ppwd</em>&nbsp;</td><td>the pwd instance handler as a result value</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>~0</em>&nbsp;</td><td>on failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="srcs_2toolbox_2pwd_8c_source.html#l00327">327</a> of file <a class="el" href="srcs_2toolbox_2pwd_8c_source.html">srcs/toolbox/pwd.c</a>.</p>

<p>References <a class="el" href="srcs_2toolbox_2pwd_8c_source.html#l00161">u_pwd_init()</a>.</p>

</div>
</div>
<a class="anchor" id="ga05ce71b28ee2271281fe4efcbfd6675e"></a><!-- doxytag: member="srcs/toolbox/pwd.c::u_pwd_rec_free" ref="ga05ce71b28ee2271281fe4efcbfd6675e" args="(u_pwd_t *pwd, u_pwd_rec_t *rec)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void u_pwd_rec_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__pwd.html#ga95bdb8d39873ee3b16a27fd3665ea41c">u_pwd_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pwd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__pwd.html#gad545d5fc0c65eb34fba6713d3ae430fc">u_pwd_rec_t</a> *&nbsp;</td>
          <td class="paramname"> <em>rec</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Dispose the supplied <a class="el" href="group__pwd.html#gad545d5fc0c65eb34fba6713d3ae430fc" title="Carry information about a single password DB record.">u_pwd_rec_t</a> object <code>rec</code>. It MUST be called on <a class="el" href="group__pwd.html#gad545d5fc0c65eb34fba6713d3ae430fc" title="Carry information about a single password DB record.">u_pwd_rec_t</a> records returned from <a class="el" href="group__pwd.html#ga9a1d5d9462850ec60a46e44bdba43b19" title="Retrieve a pwd record.">u_pwd_retr</a> when using "in memory" pwd instances (for non "in memory" pwd's the function is a NOP)</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pwd</em>&nbsp;</td><td>the pwd instance which owns <code>rec</code> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rec</em>&nbsp;</td><td>the pwd_rec record to be disposed</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>nothing </dd></dl>

<p>Definition at line <a class="el" href="srcs_2toolbox_2pwd_8c_source.html#l00346">346</a> of file <a class="el" href="srcs_2toolbox_2pwd_8c_source.html">srcs/toolbox/pwd.c</a>.</p>

<p>References <a class="el" href="memory_8c_source.html#l00085">u_free()</a>.</p>

<p>Referenced by <a class="el" href="srcs_2toolbox_2pwd_8c_source.html#l00246">u_pwd_auth_user()</a>.</p>

</div>
</div>
<a class="anchor" id="ga763ca1a183471a7c47e8c9b964b58fb6"></a><!-- doxytag: member="srcs/toolbox/pwd.c::u_pwd_rec_get_opaque" ref="ga763ca1a183471a7c47e8c9b964b58fb6" args="(u_pwd_rec_t *rec)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* u_pwd_rec_get_opaque </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__pwd.html#gad545d5fc0c65eb34fba6713d3ae430fc">u_pwd_rec_t</a> *&nbsp;</td>
          <td class="paramname"> <em>rec</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the user opaque attribute from the supplied <a class="el" href="group__pwd.html#gad545d5fc0c65eb34fba6713d3ae430fc" title="Carry information about a single password DB record.">u_pwd_rec_t</a> object</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rec</em>&nbsp;</td><td>an <a class="el" href="group__pwd.html#gad545d5fc0c65eb34fba6713d3ae430fc" title="Carry information about a single password DB record.">u_pwd_rec_t</a> object returned by <a class="el" href="group__pwd.html#ga9a1d5d9462850ec60a46e44bdba43b19" title="Retrieve a pwd record.">u_pwd_retr</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the opaque string (which can be <code>NULL</code> even if successful) </dd></dl>

<p>Definition at line <a class="el" href="srcs_2toolbox_2pwd_8c_source.html#l00401">401</a> of file <a class="el" href="srcs_2toolbox_2pwd_8c_source.html">srcs/toolbox/pwd.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga7ac6de19c0c3e4e19ddaad68de295eda"></a><!-- doxytag: member="srcs/toolbox/pwd.c::u_pwd_rec_get_password" ref="ga7ac6de19c0c3e4e19ddaad68de295eda" args="(u_pwd_rec_t *rec)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* u_pwd_rec_get_password </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__pwd.html#gad545d5fc0c65eb34fba6713d3ae430fc">u_pwd_rec_t</a> *&nbsp;</td>
          <td class="paramname"> <em>rec</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the user password attribute from the supplied <a class="el" href="group__pwd.html#gad545d5fc0c65eb34fba6713d3ae430fc" title="Carry information about a single password DB record.">u_pwd_rec_t</a> object</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rec</em>&nbsp;</td><td>an <a class="el" href="group__pwd.html#gad545d5fc0c65eb34fba6713d3ae430fc" title="Carry information about a single password DB record.">u_pwd_rec_t</a> object returned by <a class="el" href="group__pwd.html#ga9a1d5d9462850ec60a46e44bdba43b19" title="Retrieve a pwd record.">u_pwd_retr</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a NUL-terminated string carrying the user password, or <code>NULL</code> on error </dd></dl>

<p>Definition at line <a class="el" href="srcs_2toolbox_2pwd_8c_source.html#l00386">386</a> of file <a class="el" href="srcs_2toolbox_2pwd_8c_source.html">srcs/toolbox/pwd.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga5f2e179fad8d591ed47ab1a6fe65e9a6"></a><!-- doxytag: member="srcs/toolbox/pwd.c::u_pwd_rec_get_user" ref="ga5f2e179fad8d591ed47ab1a6fe65e9a6" args="(u_pwd_rec_t *rec)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* u_pwd_rec_get_user </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__pwd.html#gad545d5fc0c65eb34fba6713d3ae430fc">u_pwd_rec_t</a> *&nbsp;</td>
          <td class="paramname"> <em>rec</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the user name attribute from the supplied <a class="el" href="group__pwd.html#gad545d5fc0c65eb34fba6713d3ae430fc" title="Carry information about a single password DB record.">u_pwd_rec_t</a> object</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>rec</em>&nbsp;</td><td>an <a class="el" href="group__pwd.html#gad545d5fc0c65eb34fba6713d3ae430fc" title="Carry information about a single password DB record.">u_pwd_rec_t</a> object returned by <a class="el" href="group__pwd.html#ga9a1d5d9462850ec60a46e44bdba43b19" title="Retrieve a pwd record.">u_pwd_retr</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>a NUL-terminated string carrying the user name, or <code>NULL</code> on error </dd></dl>

<p>Definition at line <a class="el" href="srcs_2toolbox_2pwd_8c_source.html#l00370">370</a> of file <a class="el" href="srcs_2toolbox_2pwd_8c_source.html">srcs/toolbox/pwd.c</a>.</p>

</div>
</div>
<a class="anchor" id="ga9a1d5d9462850ec60a46e44bdba43b19"></a><!-- doxytag: member="srcs/toolbox/pwd.c::u_pwd_retr" ref="ga9a1d5d9462850ec60a46e44bdba43b19" args="(u_pwd_t *pwd, const char *user, u_pwd_rec_t **prec)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int u_pwd_retr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__pwd.html#ga95bdb8d39873ee3b16a27fd3665ea41c">u_pwd_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pwd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__pwd.html#gad545d5fc0c65eb34fba6713d3ae430fc">u_pwd_rec_t</a> **&nbsp;</td>
          <td class="paramname"> <em>prec</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Retrieve the <a class="el" href="group__pwd.html#gad545d5fc0c65eb34fba6713d3ae430fc" title="Carry information about a single password DB record.">u_pwd_rec_t</a> object (if any) corresponding to the supplied <code>user</code> from the <a class="el" href="group__pwd.html#ga95bdb8d39873ee3b16a27fd3665ea41c" title="default length of a password file line (can be changed at compile time via -DU_PWD_LINE_MAX=nnn...">u_pwd_t</a> instance <code>pwd</code> </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pwd</em>&nbsp;</td><td>an already initialized pwd instance </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>user</em>&nbsp;</td><td>user whose info shall be retrieved </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>prec</em>&nbsp;</td><td>retrieved user record as a result argument (the record must be free'd using u_pwd_rec_free API).</td></tr>
  </table>
  </dd>
</dl>
<dl><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>0</em>&nbsp;</td><td>on success </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>~0</em>&nbsp;</td><td>on failure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="srcs_2toolbox_2pwd_8c_source.html#l00219">219</a> of file <a class="el" href="srcs_2toolbox_2pwd_8c_source.html">srcs/toolbox/pwd.c</a>.</p>

<p>Referenced by <a class="el" href="srcs_2toolbox_2pwd_8c_source.html#l00246">u_pwd_auth_user()</a>.</p>

</div>
</div>
<a class="anchor" id="ga953feb369ad87ac17aaca82541085c21"></a><!-- doxytag: member="srcs/toolbox/pwd.c::u_pwd_term" ref="ga953feb369ad87ac17aaca82541085c21" args="(u_pwd_t *pwd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void u_pwd_term </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__pwd.html#ga95bdb8d39873ee3b16a27fd3665ea41c">u_pwd_t</a> *&nbsp;</td>
          <td class="paramname"> <em>pwd</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Dispose the supplied <a class="el" href="group__pwd.html#ga95bdb8d39873ee3b16a27fd3665ea41c" title="default length of a password file line (can be changed at compile time via -DU_PWD_LINE_MAX=nnn...">u_pwd_t</a> object <code>pwd</code> </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pwd</em>&nbsp;</td><td>the pwd instance that shall be disposed</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>nothing </dd></dl>

<p>Definition at line <a class="el" href="srcs_2toolbox_2pwd_8c_source.html#l00300">300</a> of file <a class="el" href="srcs_2toolbox_2pwd_8c_source.html">srcs/toolbox/pwd.c</a>.</p>

<p>Referenced by <a class="el" href="srcs_2toolbox_2pwd_8c_source.html#l00161">u_pwd_init()</a>.</p>

</div>
</div>
</div>
<hr>
<div>
  <div style="text-align:left">
    <a href="http://www.koanlogic.com/products.html">&larr;Products</a>
  </div>
  <div style="text-align:center;">
    &copy; 2005-2012 - <a href="http://www.koanlogic.com">KoanLogic S.r.l.</a> - All rights reserved
  </div>
</div>

</body>
</html>
